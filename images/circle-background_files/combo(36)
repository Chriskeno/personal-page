YUI.add("hermes-template-albums-list-page",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;r+="\n		",i=n["if"].call(e,e.isViewingSelf,{hash:{},inverse:c.program(4,d,t),fn:c.program(2,p,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function p(e,t){var r="",i,s;return r+='\n		<div class="photolist-empty">\n			<h4>',s={hash:{intlName:"magic-empty-states.ALBUM_EMPTY"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'</h4>\n			<a class="butt medium" href="/photos/organize/?start_tab=sets">',s={hash:{intlName:"magic-empty-states.ALBUM_EMPTY_ACTION"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</a>\n		</div>\n		",r}function d(e,t){var r="",i,s;return r+='\n		<div class="photolist-empty">\n			<h4>',s={hash:{intlName:"magic-empty-states.ALBUM_EMPTY_OTHER"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</h4>\n		</div>\n		",r}function v(e,t){var r="",i,s;return r+="\n		",s={hash:{},data:t},r+=l((i=n.outlet||e.outlet,i?i.call(e,e["pagination-view"],s):f.call(e,"outlet",e["pagination-view"],s)))+"\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],a):f.call(t,"outlet",t["global-nav-view"],a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["fluid-header"],a):f.call(t,"outlet",t["fluid-header"],a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t.subnav,a):f.call(t,"outlet",t.subnav,a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["album-list-toolbar-view"],a):f.call(t,"outlet",t["album-list-toolbar-view"],a)))+'\n\n<div role="main" class="albums-list-container fluid-centered">\n	',u=n["if"].call(t,t.isEmpty,{hash:{},inverse:c.noop,fn:c.program(1,h,i),data:i});if(u||u===0)s+=u;s+="\n	",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["photo-list-view"],a):f.call(t,"outlet",t["photo-list-view"],a)))+"\n\n\n	",u=n["if"].call(t,t.showPagination,{hash:{},inverse:c.noop,fn:c.program(6,v,i),data:i});if(u||u===0)s+=u;return s+="\n\n</div>\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["signup-footer-view"],a):f.call(t,"outlet",t["signup-footer-view"],a)))+"\n",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["footer-full-view"],a):f.call(t,"outlet",t["footer-full-view"],a))),s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/albums-list-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("fluid-share-album-view",function(e,t){e.namespace("Views").FluidShareAlbumView=e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.albumId=e.albumId,this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-album-icon",sharingDisabled:!0,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_ALBUM"})}),this.constructor.superclass.initializer.call(this,e)},loadState:function(){return e.Promise.resolve()},getItemCount:function(){return this.loadRequiredModels()},loadRequiredModels:function(){var t=this,n=1;return e.Promise.all([this.appContext.getModel("set-models",this.albumId+"-"+n,{filter:n,perPage:5,page:1}),this.appContext.getModel("album-privacy-models",this.albumId),this.appContext.getModel("set-models",this.albumId)]).then(function(e){t.set("albumModel",e[0]),t.set("privacyModel",e[1]),t.isDisabled=!e[0].getValue("canShare"),t.set("photos",e[0].getValue("photoPageList").getList()),t.set("fullAlbum",e[2]),e[2].on("valuesChanged",function(e){var n={};e&&(Object.keys(e).forEach(function(r){var i=e[r];i.id===t.albumId&&(n[r]=i.newVal)}),Object.keys(n).length>0&&t.get("albumModel").setValues(n))})},function(n){e.Flog.error(t.name,"failed to get models")})},buildContainer:function(){return this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-album-icon",sharingDisabled:this.isDisabled,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_ALBUM"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("albumModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("fullAlbum");return{url:e.URLHelper.getShortAlbumURL(t.getValue("normalizedId")),title:t.getValue("title")}},prepareTumblrShareParameters:function(){var e=this.get("fullAlbum");return{title:e.getValue("title"),authorURL:e.getValue("owner").getValue("url"),ownerName:e.getValue("owner").getValue("displayname"),description:e.getValue("description"),displayPhotoURL:this.get("photos").map(function(e){return e.getLargestSize().url}),url:e.getValue("url"),tags:"Flickr"}},preparePinterestShareParameters:function(){var t=this.get("fullAlbum");return{title:t.getValue("title"),description:t.getValue("description"),displayPhotoURL:this.get("photos").length>0?this.get("photos")[0].getLargestSize().url:null,shortURL:e.URLHelper.getShortAlbumURL(t.getValue("normalizedId")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("fullAlbum");return{modelName:"set",modelId:this.albumId,modelOwnerId:e.getValue("owner").id,title:e.getValue("title"),url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t=this.get("albumModel"),n=this.get("fullAlbum"),r,i,s,o=!1;r=this.intlMessage({intlName:"share-modal.ALBUM_PRIVACY_WARNING",photoCount:n.getValue("totalCount")});if(this.appContext.flipper.isFlipped("enable-album-download")&&n.getValue("owner").getValue("isMe")){o=!0;switch(this.appContext.getViewer().prefs.downloadAccessPref){case 4:s="ALBUM_DOWNLOAD_ACCESS_YOU";break;case 3:s="ALBUM_DOWNLOAD_ACCESS_FF";break;case 2:s="ALBUM_DOWNLOAD_ACCESS_FOLLOWING";break;case 1:s="ALBUM_DOWNLOAD_ACCESS_MEMBERS";break;case 0:s="ALBUM_DOWNLOAD_ACCESS_EVERYONE"}s&&(i=this.intlMessage({intlName:"share-modal."+s,photoCount:n.getValue("totalCount")}))}return{sizes:t.getValue("primaryPhotoSizes"),url:n.getValue("url"),title:n.getValue("title"),author:n.getValue("owner").getValue("displayname"),authorURL:n.getValue("owner").getValue("url"),albumId:t.getValue("normalizedId"),shortURL:e.URLHelper.getShortAlbumURL(n.getValue("normalizedId")),supportsEmbedr:this.appContext.flipper.isFlipped("enable-embedr-in-share")&&this.appContext.flipper.isFlipped("enable-embedr-in-albums"),supportsBBCode:!1,privacyWarningString:r,showDownloadWarning:o,downloadAccessString:i}},getTitleIntlKey:function(){return"SHARE_ALBUM_TO"},getGuestPassParams:function(){var e=this.get("privacyModel"),t=this.get("fullAlbum").getValue("owner").getValue("isMe"),n=e.getValue("countPhotosPublic"),r=e.getValue("countPhotosFriendFamily"),i=e.getValue("countPhotosFriend"),s=e.getValue("countPhotosFamily"),o=this.get("privacyModel").getValue("totalCount")-n,u=t&&r>0&&r!==n,a=t&&i>0&&i!==n,f=t&&s>0&&s!==n,l=!1;u&&i===r&&(a=!1),u&&s===r&&(f=!1);if(o>0||u||f||a)l=!0;return{type:"set",id:this.get("albumModel").getValue("normalizedId"),contentMarkedFriends:a,contentMarkedFamily:f,contentMarkedFriendFamily:u,contentMarkedPublic:n,canSharePrivate:l&&t,showGuestPassDropdown:t&&n!==this.get("fullAlbum").getValue("totalCount"),multipleItems:!0}},getIsMine:function(){return this.get("albumModel").getValue("isOwner")}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper","flog"],langBundles:[]});
YUI.add("hermes-template-album-list-toolbar",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return s+='<div class="album-toolbar-content">\n	<a class="create-album" href="/photos/organize/?start_tab=new_set"><i></i><span>',u={hash:{intlName:"album-page.CREATE_NEW_ALBUM"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):a.call(t,"intlMessage",u)))+"</span></a>\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-list-toolbar",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-list-toolbar-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{},initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){return e.Promise.resolve()},buildContainer:function(){var e=this.templates("album-list-toolbar")({});return this.setContainerHTML(e),this},buildErrorContainer:function(){},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-list-toolbar","albums-list-page-css"],optional:[],langBundles:["album-page","common"]});
YUI.add("hermes-lang-album-page",function(e,t){e.Intl.add("hermes/album-page","en-US",{PHOTOS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} photo",other:"${#} photos"}}],VIDEOS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} video",other:"${#} videos"}}],VIEWS_COUNT:[{type:"plural",valueName:"selectedCount",options:{one:"${#} view",other:"${#} views"}}],BACK_TO_ALBUMS:["Back to albums list"],EDIT_IN_ORGANIZR:["Edit in Organizr"],EDIT_COVER:["Edit cover"],SELECT_COVER_PHOTO:["Select a cover photo"],SELECT:["Select"],ERROR_COVER_PHOTO:["There was a problem trying to set your cover photo. Please try again."],ERROR_UPDATING_ALBUM_TITLE_DESCRIPTION:["There was an error updating the album's title and description."],ALBUM_ADD_DESCRIPTION:["Click here to enter a description for this album"],ERROR_CREATING_PHOTOBOOK_FROM_ALBUM:["There was a problem creating the book for this album. Please try again later."],ALBUM_DESCRIPTION:["Album description"],CREATE_BOOK_FROM_ALBUM:["Make a book from this Album"],DOWNLOAD_PHOTOS_AND_VIDEO:["Download ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}," & ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}],DOWNLOAD_PHOTOS:["Download ",{type:"plural",valueName:"photoCount",options:{one:"${#} photo",other:"${#} photos"}}],DOWNLOAD_VIDEOS:["Download ",{type:"plural",valueName:"videoCount",options:{one:"${#} video",other:"${#} videos"}}],DOWNLOAD_ZIP:["Download zip"],DOWNLOAD_ZIP_PART:["Download zip part ","${partSequence}"],ALOT_OF_PHOTOS:["Wow, that's a lot of photos! Click to download each batch as a zip file."],DOWNLOAD_ALBUM_NOT_AVAILABLE_ERROR:["There are no photos or videos available in this album for you to download."],DOWNLOAD_ALBUM_DISABLED_ERROR:["Album downloading is currently unavailable. Please try again in a minute."],DOWNLOAD_ALBUM_GENERIC_ERROR:["There was an error downloading this album. Please try again."],DOWNLOAD_ALBUM_LICENSE_MESSAGE:["These photos may have one or more license types. Please visit the individual photo page for more information about the license prior to downloading this album."],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT:["These photos may have one or more license types. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image"],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2:["These photos may have one or more license types or their rights may be reserved. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image."],DOWNLOAD_ALBUM_LEARN_MORE:['Learn more at <a href="https://www.flickr.com/creativecommons" target="_blank">Creative Commons</a>'],CONFIRM_ALBUM_DELETE_NO_CONTENTS_DELETED:["Do you really want to delete this album? (Don't worry, none of the contents will be deleted.)"],DELETE_THIS_ALBUM:["Delete this album"],SHARE_THIS_ALBUM:["Share this album"],CREATE_NEW_ALBUM:["Create new album"],SORT:["Sort"],SORT_DATE_TAKEN_OLDEST:["Sort by date taken (oldest first)"],SORT_DATE_TAKEN_NEWEST:["Sort by date taken (newest first)"],SORT_DATE_UPLOADED_OLDEST:["Sort by date uploaded (oldest first)"],SORT_DATE_UPLOADED_NEWEST:["Sort by date uploaded (newest first)"],SORT_ALPHABETICALLY:["Alphabetically"],SORT_RANDOMLY:["Randomly"],SORT_REVERSE:["Reverse current order"],SORT_ALMOST_DONE:["Almost done..."]})},"@VERSION@",{requires:["intl"]});
YUI.add("albums-list-page-view",function(e){e.namespace("Views")[this.name]=e.Base.create("albums-list-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.nsid=t.nsid,this.isOwner=t.isOwner,this.withSetId=t.withSetId,this.pageParams=t.pageParams,t.modelRegistryName="sets-models",t.photoListConfig={modelParams:{registryName:"sets-models",modelIdOrAttributes:t.nsid,collectionAttributeName:"albumsList"},interactionViewName:"photo-list-album-interaction-view",engagementModelName:"set-models",viewBeaconRestrictedAttribute:"primaryNeedsInterstitial",parentName:this.name,pageParams:t.pageParams,viewBeaconAttribute:"primary",measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:t.withSetId},t.photoListConfig.layout={targetRowHeight:240,forceAspectRatio:1,containerPadding:{top:8,right:0,bottom:8,left:0},itemSpacing:{horizontal:32,vertical:32}},this.appContext.getUA().isMobileBrowser&&(t.photoListConfig.layout.targetRowHeight=200,t.photoListConfig.layout.containerPadding.right=16,t.photoListConfig.layout.containerPadding.left=16,t.photoListConfig.layout.itemSpacing.horizontal=16,t.photoListConfig.layout.itemSpacing.vertical=16),t.subnavConfig={selected:"albums"},this.aftHelper=new e.PhotolistAftHelper(this),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"fluid-photostream-coverphoto-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-list-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,additionalViewClasses:["fluid-centered"]},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"signup-footer-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return e.isMobile||!this.appContext.flipper.isFlipped("enable-mini-sign-up-footer")||this.appContext.getViewer().signedIn||this.appContext.lang!=="en-US"}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("sets-models",this.nsid).then(function(t){e.set("albumsListModel",t),e.set("totalItems",t.getValue("totalItems"))})},buildContainer:function(){var e,t=this.get("totalItems"),n,r;return r=this.pageParams.page>1||t>Math.abs((this.pageParams.viewPageSize||20)*(this.pageParams.page||1)),n=this.nsid===this.appContext.getViewer().nsid&&t>0,e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"fluid-header":this.subviews["fluid-photostream-coverphoto-view"]?this.subviews["fluid-photostream-coverphoto-view"].get("container"):"",subnav:this.subviews["fluid-magic-subnav-view"]?this.subviews["fluid-magic-subnav-view"].get("container"):"","photo-list-view":this.subviews["photo-list-view"].get("container"),"pagination-view":this.subviews["pagination-view"].get("container"),"album-list-toolbar-view":n?this.subviews["album-list-toolbar-view"].get("container"):"","footer-full-view":this.subviews["footer-full-view"].get("container"),showPagination:r,isEmpty:this.get("totalItems").length===0,isViewingSelf:this.nsid===this.appContext.getViewer().nsid,"signup-footer-view":this.subviews["signup-footer-view"]?this.subviews["signup-footer-view"].get("container"):""},this.setContainerHTML(this.templates("albums-list-page")(e)),this},buildHeadContainer:function(){var e="";e+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1"}),e+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),e+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",e):(this.set("headContainer",this.subviews["pagination-view"].get("headContainer")),this.updateHead())},showErrorModal:function(t){var n;n=new e.Views.FluidModal({appContext:this.appContext,darkOverlay:!0,dismissOnOverlayClick:!0,showCancelButton:!1,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),title:this.intlMessage({intlName:"common.UPLOAD_ERROR_TITLE"}),message:t}),n.show()},createBook:function(t){var n=this;return this.showBalls(),e.rapidTracker.beacon(this.name,"createBook"),this.appContext.getModelRegistry("book-models").then(function(e){return e.remoteCreate({photoset_id:t}).then(function(e){n.hideBalls(),n.appContext.flapp.navigate("/create/books/"+e.id+"/cover")})}).catch(function(e){n.hideBalls(),n.showErrorModal("There was a problem creating the book. Please try again later")})},showBalls:function(){this.balls||(this.balls=e.Node.create('<div class="loading-balls"></div>'),this.balls.setHTML(this.templates("flickr-balls")({}))),this.get("container").append(this.balls)},hideBalls:function(){this.balls.remove()},downloadAlbum:function(t){var n=this,r,i;e.rapidTracker.beacon(this.name,"openDownloadAlbum"),i=this.get("albumsListModel").getOwnedModels().find(function(e){return e.id===t}),i&&this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===i.getValue("owner").id&&this.bulkDownloaderView.set("isOwnAlbum",!0),r=this.bulkDownloaderView.showLoadingDialog(),this.bulkDownloaderView.prepareArchive({set_id:t}).then(function(e){r.close(),n.bulkDownloaderView.showDownloadDialog(e)}).catch(function(e){r.close(),n.bulkDownloaderView.onError(e)})},shareAlbum:function(t,n){var r=new e.Views.FluidShareAlbumView({appContext:this.appContext,albumId:t});this.showBalls(),e.rapidTracker.beacon(this.name,"openShareAlbum"),r.on("sharePresentationClose",r.destroy.bind(r)),r.initialize().then(function(){this.prepareModal(n)}.bind(r)).then(function(){this.hideBalls()}.bind(this)).catch(function(e){this.hideBalls()}.bind(this))},deleteAlbum:function(t){var n=this;return e.rapidTracker.beacon(this.name,"deleteAlbum"),this.showBalls(),this.confirmAlbumDelete(t).then(function(){return n.appContext.getModel("set-models",t).then(function(r)
{var i=[];return r.toJSON().photoPageList.forEach(function(e){i.push(n.appContext.getModel("photo-sets-models",e.id).then(function(e){e.getValue("sets").removeFromList(t)}))}),i.push(r.registry.remoteDelete(t).then(function(){n.get("albumsListModel").getValue("albumsList").remove(t),n.appContext.flapp.navigate(e.config.doc.location.href)})),e.Promise.all(i)})}).catch(function(t){t&&e.Flog.error("Error deleting album: ",t),n.hideBalls()})},confirmAlbumDelete:function(t){var n=this;return e.rapidTracker.beacon(this.name,"deleteConfirm"),new e.Promise(function(t,r){var i=new e.Views.FluidModal({appContext:n.appContext,title:n.intlMessage({intlName:"common.CONFIRMATION"}),message:n.intlMessage({intlName:"album-page.CONFIRM_ALBUM_DELETE_NO_CONTENTS_DELETED"})});n.registerEventHandler(i.on("actionClick",function(){t()})),n.registerEventHandler(i.on("cancelClick",function(){e.rapidTracker.beacon(n.name,"cancelDeleteConfirm"),r()})),i.show()})},handleClick:function(e){var t=e.target,n,r;t.hasClass("cta")&&(e.halt(),n=t.ancestor(".photo-list-album-interaction"),r=n.getData("albumId"),t.hasClass("is-disabled")||(t.hasClass("share")?this.shareAlbum(r,t):t.hasClass("book")?this.createBook(r):t.hasClass("download")?this.downloadAlbum(r):t.hasClass("trash")&&this.deleteAlbum(r)))},destructor:function(){this.balls&&this.balls.inDoc()&&this.balls.remove(),this.balls=null,this.bulkDownloaderView&&this.bulkDownloaderView.destroy()},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.handleClick,this)),this.bulkDownloaderView=new e.BulkDownloaderView({appContext:this.appContext}),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handlePageResize.bind(this))),this},handlePageResize:function(){var t=e.config.win.innerWidth;t<=700?this.hasBeenMobilized||(this.hasBeenMobilized=!0,this.subviews["photo-list-view"].photoListLayout.targetRowHeight=200,this.subviews["photo-list-view"].photoListLayout.containerPadding.right=16,this.subviews["photo-list-view"].photoListLayout.containerPadding.left=16,this.subviews["photo-list-view"].photoListLayout.itemSpacing.horizontal=16,this.subviews["photo-list-view"].photoListLayout.itemSpacing.vertical=16):(this.hasBeenMobilized&&(this.subviews["photo-list-view"].photoListLayout.targetRowHeight=240,this.subviews["photo-list-view"].photoListLayout.containerPadding.right=0,this.subviews["photo-list-view"].photoListLayout.containerPadding.left=0,this.subviews["photo-list-view"].photoListLayout.itemSpacing.horizontal=32,this.subviews["photo-list-view"].photoListLayout.itemSpacing.vertical=32),this.hasBeenMobilized=!1)},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600578}}})},"@VERSION@",{requires:["flog","flutil","flickr-view","flickr-promise","hermes-template-albums-list-page","favorites-page-css","global-nav-view","footer-full-view","pagination-view","fluid-photostream-coverphoto-view","fluid-share-album-view","albums-list-page-css","hermes-template-flickr-balls","fluid-balls-css","album-list-toolbar-view","hermes-template-head-link","photolist-aft-helper","hermes-template-head-meta"],optionalRequires:["bulk-downloader-view"],optional:["sets-models","book-models"],langBundles:["album-page","common","magic-empty-states","meta"]});
YUI.add("hermes-template-bulk-download-modal",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i,s;return r+="\n	<p>",s={hash:{intlName:"album-page.DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</p>\n",r}function h(e,t){var r="",i,s;return r+="\n	<p>",s={hash:{intlName:"album-page.ALOT_OF_PHOTOS"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</p>\n",r}function p(e,t){var r="",i;r+="\n	<ul>\n		",i=n.each.call(e,e.downloadURLs,{hash:{},inverse:l.noop,fn:l.program(6,d,t),data:t});if(i||i===0)r+=i;return r+="\n	</ul>\n",r}function d(e,t){var r="",i,s,o;return r+="\n			<li>\n				<span>\n					",o={hash:{intlName:"album-page.DOWNLOAD_ZIP_PART",partSequence:e.partSequence},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):u.call(e,"intlMessage",o)))+'\n				</span>\n				<a class="butt mini" href="',(s=n.url)?s=s.call(e,{hash:{},data:t}):(s=e.url,s=typeof s===f?s.apply(e):s),r+=a(s)+'">',o={hash:{intlName:"common.DOWNLOAD"},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,o):u.call(e,"intlMessage",o)))+"</a>\n			</li>\n		",r}function v(e,t){var r="",i,s;return r+='\n	<a class="butt mini" href="'+a((i=(i=(i=e.downloadURLs,i==null||i===!1?i:i[0]),i==null||i===!1?i:i.url),typeof i===f?i.apply(e):i))+'">',(s=n.buttonLabel)?s=s.call(e,{hash:{},data:t}):(s=e.buttonLabel,s=typeof s===f?s.apply(e):s),r+=a(s)+"</a>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f="function",l=this;o=n.unless.call(t,t.isOwnAlbum,{hash:{},inverse:l.noop,fn:l.program(1,c,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n["if"].call(t,t.isMany,{hash:{},inverse:l.noop,fn:l.program(3,h,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n["if"].call(t,t.isMany,{hash:{},inverse:l.program(8,v,i),fn:l.program(5,p,i),data:i});if(o||o===0)s+=o;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/bulk-download-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("bulk-downloader-view",function(e,t){"use strict";e.BulkDownloaderView=e.Base.create("BulkDownloaderView",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.localizeLib=e.mix({langBundles:["common","album-page","cameraroll"],appContext:this.appContext},e.Localizable),this.set("isOwnAlbum",t.isOwnAlbum)},showLoadingDialog:function(){var t=(new e.Views.FluidModal({appContext:this.appContext,showCancelButton:!1,showFooter:!1,showActionButton:!1,title:this.localizeLib.intlMessage({intlName:"cameraroll.PREPARING_DOWNLOAD"}),message:this.templates("flickr-balls")({}),classList:"bulk-download-loading-dialog"})).show();return t},prepareArchive:function(e){var t=this;return this.appContext.callAPI("flickr.download.archives.create",e).then(function(e){var n=e.archive.countPhotos,r=e.archive.countVideos,i=[],s,o;if(n>0&&r>0)s=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS_AND_VIDEO",photoCount:n,videoCount:r});else if(n>0&&r===0)s=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:n});else{if(!(n===0&&r>0))throw new Error(t.localizeLib.intlMessage({intlName:"cameraroll.DOWNLOAD_NOT_AVAILABLE_ERROR"}));s=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:r})}return r+n>1?o=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_ZIP"}):n===1&&r===0?o=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_PHOTOS",photoCount:n}):n===0&&r===1&&(o=t.localizeLib.intlMessage({intlName:"album-page.DOWNLOAD_VIDEOS",videoCount:r})),i=e.archive.urls.map(function(e,t){return{url:e,partSequence:t+1}}),{title:s,downloadURLs:i,buttonLabel:o}}).catch(function(e){throw e.code===105?new Error(t.localizeLib.intlMessage({intlName:"cameraroll.DOWNLOAD_DISABLED_ERROR"})):new Error(t.localizeLib.intlMessage({intlName:"cameraroll.DOWNLOAD_GENERIC_ERROR"}))})},showDownloadDialog:function(n){var r=n.title,i=n.downloadURLs,s;return s=(new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,showFooter:!1,showActionButton:!1,title:r,message:this.templates("bulk-download-modal")({isMany:i.length>1,downloadURLs:i,buttonLabel:n.buttonLabel,isOwnAlbum:this.get("isOwnAlbum")}),classList:"bulk-download-dialog"})).show(),s.on("activated",function(){s.get("container").all(".butt").on("click",function(n){i.length===1?(e.rapidTracker.beacon(t,"completeArchiveDownloadClick"),s.close()):(e.rapidTracker.beacon(t,"partialArchiveDownloadClick"),n.target.addClass("is-disabled"))})}),s},onError:function(t){var n=new e.Views.FluidModal({appContext:this.appContext,title:this.localizeLib.intlMessage({intlName:"common.ERROR"}),message:t.message,actionButtonLabel:this.localizeLib.intlMessage({intlName:"common.OK"}),showCancelButton:!1});n.show()}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-modal-view","hermes-template-bulk-download-modal","hermes-template-flickr-balls","fluid-balls-css","bulk-download-modal-css"],langBundles:["common","album-page","cameraroll"],optional:[],affinity:"client"});
