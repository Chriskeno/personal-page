YUI.add("hermes-template-album-page",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression;return u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["global-nav-view"],u):a.call(t,"outlet",t["global-nav-view"],u)))+'\n\n<div role="main" class="album-container fluid-centered">\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["album-toolbar-view"],u):a.call(t,"outlet",t["album-toolbar-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["album-header-view"],u):a.call(t,"outlet",t["album-header-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["photo-list-view"],u):a.call(t,"outlet",t["photo-list-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["pagination-view"],u):a.call(t,"outlet",t["pagination-view"],u)))+"\n\n</div>\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["signup-footer-view"],u):a.call(t,"outlet",t["signup-footer-view"],u)))+"\n",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["footer-full-view"],u):a.call(t,"outlet",t["footer-full-view"],u))),s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-album-toolbar",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i,s;return r+='\n		<a class="edit-in-organizr" href="/photos/organize/?start_tab=one_set',(i=n.setId)?i=i.call(e,{hash:{},data:t}):(i=e.setId,i=typeof i===f?i.apply(e):i),r+=l(i)+'">',s={hash:{intlName:"album-page.EDIT_IN_ORGANIZR"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</a>\n	",r}function d(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;s+='<div class="album-toolbar-content">\n	<a class="back-to-albums" href="/photos/',(o=n.nsidOrPathAlias)?o=o.call(t,{hash:{},data:i}):(o=t.nsidOrPathAlias,o=typeof o===f?o.apply(t):o),s+=l(o)+"/albums/with/",(o=n.setId)?o=o.call(t,{hash:{},data:i}):(o=t.setId,o=typeof o===f?o.apply(t):o),s+=l(o)+'">\n		<span class="back-to-albums-icon"></span>\n		<span class="back-to-albums-text">\n			',a={hash:{intlName:"album-page.BACK_TO_ALBUMS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+"\n		</span>\n	</a>\n	",u=n["if"].call(t,t.viewerIsOwner,{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n	",a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["fluid-magic-slideshow-view"],a):c.call(t,"outlet",t["fluid-magic-slideshow-view"],a)))+'\n	<button data-layout="justified" class="layout justified',u=n["if"].call(t,t.isJustifiedLayout,{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+='"></button>\n	<button data-layout="story" class="layout story',u=n["if"].call(t,t.isStoryLayout,{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;return s+='"></button>\n</div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-toolbar",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-toolbar-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"fluid-magic-slideshow-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.nsidOrPathAlias=e.nsidOrPathAlias,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("set-models",e.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){var e=this.get("albumModel"),t=e.id,n=!1,r;return this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===e.getValue("owner").id&&(n=!0),r=this.templates("album-toolbar")({nsidOrPathAlias:this.nsidOrPathAlias,viewerIsOwner:n,setId:t,"fluid-magic-slideshow-view":this.subviews["fluid-magic-slideshow-view"]?this.subviews["fluid-magic-slideshow-view"].get("container"):"",isJustifiedLayout:this.albumPhotoListLayoutStyle==="justified",isStoryLayout:this.albumPhotoListLayoutStyle==="story"}),this.setContainerHTML(r),this},buildErrorContainer:function(){},activate:function(){var t=this.get("container"),n=this;return this.registerEventHandler(t.all(".layout").on("click",function(r){r.preventDefault();var i=r.target.getAttribute("data-layout");i!==n.layoutStyle&&(t.one(".selected").removeClass("selected"),r.target.addClass("selected"),e.fire("albumToolbarView:layoutChange",i),n.layoutStyle=i)})),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-toolbar","fluid-magic-slideshow-view","album-page-css"],optional:[],langBundles:["album-page"]});
YUI.add("hermes-template-album-header",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i,s,o;r+='\n		<span class="edit-cover-photo" title="',o={hash:{intlName:"album-page.EDIT_COVER"},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,o):a.call(e,"intlMessage",o)))+'">\n			<i></i>\n		</span>\n		',o={hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t},s=(i=n.isFlipped||e.isFlipped,i?i.call(e,e.flippers,"enable-change-album-sorting",o):a.call(e,"isFlipped",e.flippers,"enable-change-album-sorting",o));if(s||s===0)r+=s;return r+="\n	",r}function p(e,t){var r="",i,s;return r+='\n			<span class="change-album-sorting">\n				',s={hash:{intlName:"album-page.SORT"},data:t},r+=f((i=n.intlMessage||e.intlMessage,i?i.call(e,s):a.call(e,"intlMessage",s)))+"<i></i>\n			</span>\n		",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a=n.helperMissing,f=this.escapeExpression,l=this,c="function";s+='<div class="album-header-content" style="height: ',(o=n.height)?o=o.call(t,{hash:{},data:i}):(o=t.height,o=typeof o===c?o.apply(t):o),s+=f(o)+"px; background-image: url(",(o=n["cover-photo-url"])?o=o.call(t,{hash:{},data:i}):(o=t["cover-photo-url"],o=typeof o===c?o.apply(t):o),s+=f(o)+');">\n\n	<div class="dimming-shim"></div>\n	<div class="flex-padding"></div>\n\n	',o=n["if"].call(t,t.viewerIsOwner,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;return s+="\n\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["album-title-desc-view"],u):a.call(t,"outlet",t["album-title-desc-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["album-stats-view"],u):a.call(t,"outlet",t["album-stats-view"],u)))+"\n	",u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["album-engagement-view"],u):a.call(t,"outlet",t["album-engagement-view"],u)))+'\n	<div class="flex-padding"></div>\n\n	',u={hash:{},data:i},s+=f((o=n.outlet||t.outlet,o?o.call(t,t["attribution-view"],u):a.call(t,"outlet",t["attribution-view"],u)))+"\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-header",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-album-title-desc",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){return"editable"}function d(e,t){var r="",i,s;return r+='\n		<span class="title-desc-edit" data-action="edit" title="',s={hash:{intlName:"common.EDIT"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'"></span>\n	',r}function v(e,t){return"description-placeholder"}function m(e,t){var r="",i,s;return r+="\n			",s={hash:{},data:t},r+=l((i=n.renderTrustedMarkup||e.renderTrustedMarkup,i?i.call(e,e.description,s):f.call(e,"renderTrustedMarkup",e.description,s)))+"\n		",r}function g(e,t){var r="",i;r+="\n			",i=n["if"].call(e,e.canEdit,{hash:{},inverse:c.noop,fn:c.program(10,y,t),data:t});if(i||i===0)r+=i;return r+="\n		",r}function y(e,t){var r="",i,s;return r+="\n				",s={hash:{intlName:"album-page.ALBUM_ADD_DESCRIPTION"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"\n			",r}function b(e,t){var r="",i,s;return r+='\n	<button class="done-editing-album-title-desc hidden" data-action="saveAlbumTitleDescEdit">',s={hash:{intlName:"common.DONE"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+"</button>\n",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this,h="function";s+='<div class="title-desc-block ',o=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+='">\n	<div class="',o=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+=' album-title">\n		',(o=n.title)?o=o.call(t,{hash:{},data:i}):(o=t.title,o=typeof o===h?o.apply(t):o),s+=l(o)+"\n	</div>\n\n	",o=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(3,d,i),data:i});if(o||o===0)s+=o;s+='\n\n	<input type="text" class="meta-field edit-meta-field edit-album-title" wrap="on"></input>\n\n	<div class="',o=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+=" album-desc ",o=n.unless.call(t,t.description,{hash:{},inverse:c.noop,fn:c.program(5,v,i),data:i});if(o||o===0)s+=o;s+='">\n		',o=n["if"].call(t,t.description,{hash:{},inverse:c.program(9,g,i),fn:c.program(7,m,i),data:i});if(o||o===0)s+=o;s+='\n	</div>\n\n	<div class="description-show-more hidden">\n		<span class="description-show-more-link ',o=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(1,p,i),data:i});if(o||o===0)s+=o;s+='" data-action="showMore">\n			',a={hash:{intlName:"common.SHOW_MORE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):f.call(t,"intlMessage",a)))+'\n		</span>\n	</div>\n\n	<textarea class="meta-field edit-meta-field edit-album-desc" wrap="on"></textarea>\n</div>\n\n',u=n["if"].call(t,t.canEdit,{hash:{},inverse:c.noop,fn:c.program(12,b,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-title-desc",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-title-desc-view",function(e){var t={bigFont:"26px",smallFont:"18px",heightOfOneLineOfTextUsingBigFont:29,maxNumberOfLinesOfDescriptionToShow:2,maxNumberOfLinesOfDescriptionToShowJustified:1,maxNumberOfLinesOfDescriptionToShowInEditField:4,currentDescriptionEditableFieldHeight:29,heightOfOneLineOfTextWhenJustified:29};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("set-models",e.albumId).then(function(t){e.set("albumModel",t)})},wrapDescription:function(e){var t;return e=e.split("\n"),t=e.length,t>1&&e.forEach(function(e,t,n){n[t]=e+"<br>"}),e.join("")},doneEditingTitleDescription:function(){var n=this,r=this.get("albumModel"),i,s,o=n.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),u=r.getValue("title").trim(),a=r.getValue("description").trim(),f=this.get("container"),l=f.one(".album-desc"),c=f.one(".album-title"),h=f.one(".edit-album-desc"),p=f.one(".edit-album-title"),d=f.one(".done-editing-album-title-desc");f.removeClass("editing"),i=p.get("value").trim(),i===""&&(i=u),h.get("value")!==o?s=h.get("value").trim():s="",d.addClass("hidden"),n.fire("subviewViewEvent","albumTitleDesc:doneEditing"),i!==u||s!==a?(r.setValue("title",i),r.setValue("description",s),e.rapidTracker.beacon(n.name,"albumTitleDescriptionSave"),r.remoteUpdate().then(function(){var e=r.getValue("title"),i=r.getValue("description");c.set("text",e),i.trim()!==""?(l.removeClass("description-placeholder"),i=n.wrapDescription(i),l.setHTML(i)):(l.addClass("description-placeholder"),l.setHTML(o)),p.removeClass("show-editable"),h.removeClass("show-editable"),c.removeClass("hidden"),l.removeClass("hidden"),f.hasClass("justified")?n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow)},function(e){r.setValue("title",u),r.setValue("description",a),c.set("text",u),a.trim()!==""?(l.removeClass("description-placeholder"),l.setHTML(a)):(l.addClass("description-placeholder"),l.setHTML(o)),p.removeClass("show-editable"),h.removeClass("show-editable"),c.removeClass("hidden"),l.removeClass("hidden"),f.hasClass("justified")?n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow),n.onError(n.intlMessage({intlName:"album-page.ERROR_UPDATING_ALBUM_TITLE_DESCRIPTION"}))})):(p.removeClass("show-editable"),h.removeClass("show-editable"),c.removeClass("hidden"),s.trim()===""?(l.addClass("description-placeholder"),l.setHTML(o)):(s=n.wrapDescription(s),l.removeClass("description-placeholder"),l.setHTML(s)),l.removeClass("hidden"),f.hasClass("justified")?n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow)),f.hasClass("justified")&&t.currentDescriptionEditableFieldHeight!==t.heightOfOneLineOfTextWhenJustified&&(n.fire("subviewViewEvent","albumTitleDescEditing:heightChange",t.heightOfOneLineOfTextWhenJustified-t.currentDescriptionEditableFieldHeight),t.currentDescriptionEditableFieldHeight=t.heightOfOneLineOfTextWhenJustified)},editTitleDescription:function(t){var n=this,r=this.get("container"),i=n.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),s=r.one(".album-title"),o,u=r.one(".edit-album-desc"),a=r.one(".edit-album-title"),f=this.get("albumModel"),l=f.getValue("title"),c=f.getValue("description").trim(),h,p=r.one(".description-show-more"),d=r.one(".done-editing-album-title-desc");(t.target.hasClass("editable album-title")||t.target.hasClass("editable album-desc")||t.target.ancestor().hasClass("editable album-desc")||t.target.hasClass("title-desc-edit")||t.target.hasClass("description-show-more-link editable")||t.target.hasClass("title-desc-block editable"))&&t.target.get("tagName").toLowerCase()!=="a"&&(t.preventDefault(),t.stopPropagation(),r.addClass("editing"),p.addClass("hidden"),n.fire("subviewViewEvent","albumTitleDesc:editing"),d.removeClass("hidden"),o=s.getXY(),a.set("value",l),a.setStyle("height",s.get("offsetHeight")),a.setStyle("width",s.get("offsetWidth")),a.setStyle("left",o[0]),a.setStyle("top",o[1]),s.addClass("hidden"),a.addClass("show-editable"),c?(h=c.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<"),u.removeClass("description-placeholder")):(h=i,u.addClass("description-placeholder")),u.set("value",h),n.makeDescriptionEditFieldResponsive(),t.target.hasClass("editable album-title")?a.focus():u.focus(),e.rapidTracker.beacon(n.name,"albumTitleDescriptionEdit"))},makeDescriptionEditFieldResponsive:function(){var e=this,n=this.get("container"),r=n.one(".album-desc"),i,s,o,u,a=n.one(".edit-album-desc"),f=a.get("value"),l,c=!1;n.hasClass("justified")&&(c=!0),f?(f=f.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),f=e.wrapDescription(f),r.addClass("calculating").removeClass("hidden"),r.setHTML(f),s=parseInt(r.getComputedStyle("height"),10),s>t.heightOfOneLineOfTextUsingBigFont*t.maxNumberOfLinesOfDescriptionToShowInEditField?a.setStyle("height",t.heightOfOneLineOfTextUsingBigFont*t.maxNumberOfLinesOfDescriptionToShowInEditField):a.setStyle("height",s),c&&(l=parseInt(a.getComputedStyle("height"),10),l!==t.currentDescriptionEditableFieldHeight&&(i=l-t.currentDescriptionEditableFieldHeight,e.fire("subviewViewEvent","albumTitleDescEditing:heightChange",i),t.currentDescriptionEditableFieldHeight=l)),o=r.get("offsetWidth"),u=r.getXY(),a.setStyle("width",o),a.setStyle("left",u[0]),a.setStyle("top",u[1]),r.addClass("hidden").removeClass("calculating"),a.addClass("show-editable")):(a.setStyle("height",t.heightOfOneLineOfTextUsingBigFont),r.addClass("hidden").removeClass("calculating"))},displayShowMoreIfNeeded
:function(e){var n=this.get("container"),r,i=n.one(".album-desc"),s=n.one(".title-desc-block"),o=n.one(".description-show-more");i&&(r=i.cloneNode(!0),r.removeClass("album-desc"),r.addClass("album-desc-calculator"),s.append(r),parseInt(r.getComputedStyle("height"),10)>t.heightOfOneLineOfTextUsingBigFont*e?o.removeClass("hidden"):o.addClass("hidden"),r.remove(!0))},showMoreClick:function(t){var n=this,r=this.get("albumModel"),i=r.getValue("description"),s=this.get("container").one(".description-show-more"),o;i=n.wrapDescription(i),t.target.hasClass("editable")?(s.addClass("hidden"),n.editTitleDescription(t)):(o=new e.Views.FluidModal({appContext:n.appContext,title:n.intlMessage({intlName:"album-page.ALBUM_DESCRIPTION"}),message:i,actionButtonLabel:n.intlMessage({intlName:"common.OK"}),showCancelButton:!1,classList:"album-full-description"}),o.show())},buildContainer:function(){var e=this,t=this.get("albumModel"),n=t.getValue("title"),r=t.getValue("description"),i=t.getValue("isAutoUploadSet"),s=!1,o=!1,u=this.get("container"),a;return r.trim()!==""&&(o=!0,this.albumPhotoListLayoutStyle==="justified"&&u.addClass("justified"),r=e.wrapDescription(r)),this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===t.getValue("owner").id&&!i&&(s=!0),a=this.templates("album-title-desc")({title:n,description:r,hasDescription:o,canEdit:s}),this.setContainerHTML(a),this},buildErrorContainer:function(){},activate:function(){var n=this,r=this.get("albumModel"),i=this.get("container"),s=n.intlMessage({intlName:"album-page.ALBUM_ADD_DESCRIPTION"}),o=i.one(".title-desc-block"),u=i.one(".edit-album-title"),a=i.one(".edit-album-desc"),f=i.one(".title-desc-edit"),l=i.one(".description-show-more-link"),c=!1;return this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===r.getValue("owner").id&&(c=!0),i.hasClass("justified")?n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified):n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow),c&&!r.getValue("isAutoUploadSet")&&(n.registerEventHandler(o.on("click",function(e){n.editTitleDescription(e)},o)),n.registerEventHandler(f.on("click",function(e){n.editTitleDescription(e)},f))),n.registerEventHandler(l.on("click",function(e){n.showMoreClick(e)},l)),this.registerEventHandler(u.on("keyup",function(e){e.keyCode===13&&n.doneEditingTitleDescription()},this)),this.registerEventHandler(u.on("blur",function(t){setTimeout(function(){try{!e.config.doc.activeElement.isEqualNode(u.getDOMNode())&&!e.config.doc.activeElement.classList.contains("edit-album-desc")&&n.doneEditingTitleDescription()}catch(t){}},1,u)},this)),this.registerEventHandler(a.on("keyup",function(e){n.makeDescriptionEditFieldResponsive()},this)),this.registerEventHandler(a.on("blur",function(t){a.get("value").trim()===""?(a.addClass("description-placeholder"),a.set("value",s)):a.removeClass("description-placeholder"),setTimeout(function(){try{!e.config.doc.activeElement.isEqualNode(a.getDOMNode())&&!e.config.doc.activeElement.classList.contains("edit-album-title")&&n.doneEditingTitleDescription()}catch(t){}},1,a)},this)),this.registerEventHandler(a.on("focus",function(){a.get("value").trim()===s&&(a.removeClass("description-placeholder"),a.set("value",""))},this)),e.on("albumToolbarView:layoutChange",function(e){e==="justified"?(i.addClass("justified"),n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShowJustified)):(i.removeClass("justified"),n.displayShowMoreIfNeeded(t.maxNumberOfLinesOfDescriptionToShow))}),this},onError:function(t){return this.errorDialog=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,darkOverlay:!0}),this.errorDialog.show(),this.errorDialog}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-title-desc","album-title-desc-css","handlebars-helpers"],optional:[],langBundles:["common","album-page"]});
YUI.add("hermes-template-album-stats",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function l(e,t){var r="",i,s;return r+='\n		<span class="photo-counts">',s={hash:{intlName:"album-page.PHOTOS_COUNT",selectedCount:e.photosArePresent},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n	",r}function c(e,t){var r="",i,s;r+="\n		",i=n["if"].call(e,e.photosArePresent,{hash:{},inverse:f.noop,fn:f.program(4,h,t),data:t});if(i||i===0)r+=i;return r+='\n		<span class="video-counts">',s={hash:{intlName:"album-page.VIDEOS_COUNT",selectedCount:e.videosArePresent},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n	",r}function h(e,t){return'\n			<span class="album-stats-separator">&middot;</span>\n		'}function p(e,t){var r="",i,s;return r+='\n		<span class="album-stats-separator">&middot;</span>\n		<span class="view-counts">',s={hash:{intlName:"album-page.VIEWS_COUNT",selectedCount:e.viewsArePresent},data:t},r+=a((i=n.intlMessage||e.intlMessage,i?i.call(e,s):u.call(e,"intlMessage",s)))+"</span>\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f=this;s+='<div class="stats-container">\n	',o=n["if"].call(t,t.photosArePresent,{hash:{},inverse:f.noop,fn:f.program(1,l,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.videosArePresent,{hash:{},inverse:f.noop,fn:f.program(3,c,i),data:i});if(o||o===0)s+=o;s+="\n	",o=n["if"].call(t,t.viewsArePresent,{hash:{},inverse:f.noop,fn:f.program(6,p,i),data:i});if(o||o===0)s+=o;return s+="\n</div>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-stats",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-stats-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this;return e.appContext.getModel("set-models",e.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){var e=this.get("albumModel"),t=e.getValue("photoCount"),n=e.getValue("videoCount"),r=e.getValue("viewCount"),i=this.get("container"),s;return this.albumPhotoListLayoutStyle==="justified"&&i.addClass("justified"),s=this.templates("album-stats")({photosArePresent:t,videosArePresent:n,viewsArePresent:r}),this.setContainerHTML(s),this},buildErrorContainer:function(){},activate:function(){return this},onParentViewEvent:function(e,t){var n=this,r=n.get("container");if(e==="album-stats-view"&&t[0]==="albumHeaderView:editing")return r.addClass("invisible"),!1;if(e==="album-stats-view"&&t[0]==="albumHeaderView:doneEditing")return r.removeClass("invisible"),!1}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-stats"],optional:[],langBundles:["common","album-page"]});
YUI.add("hermes-template-album-engagement",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i,s;return r+='\n	<div class="create-book-container">\n		<span class="create-book-icon" title="',s={hash:{intlName:"album-page.CREATE_BOOK_FROM_ALBUM"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):f.call(e,"intlMessage",s)))+'"></span>\n	</div>\n',r}function p(e,t){return'\n	<div class="download-album-container">\n		<span class="download-album-icon"></span>\n	</div>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=n.helperMissing,l=this.escapeExpression,c=this;a={hash:{},data:i},s+=l((o=n.outlet||t.outlet,o?o.call(t,t["fluid-share-album-view"],a):f.call(t,"outlet",t["fluid-share-album-view"],a)))+"\n\n",u=n["if"].call(t,t.viewerIsOwner,{hash:{},inverse:c.noop,fn:c.program(1,h,i),data:i});if(u||u===0)s+=u;s+="\n\n\n",u=n["if"].call(t,t.enableDownload,{hash:{},inverse:c.noop,fn:c.program(3,p,i),data:i});if(u||u===0)s+=u;return s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/album-engagement",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("album-engagement-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"fluid-share-album-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,parentViewName:this.name}},loadState:function(){var e=this;return e.appContext.getModel("set-models",e.albumId).then(function(t){e.set("albumModel",t)})},createBookFromAlbum:function(){var t=this;t.appContext.getModelRegistry("book-models").then(function(n){return n.remoteCreate({photoset_id:t.albumId}).then(function(n){e.rapidTracker.beacon(t.name,"photobookFromAlbum"),t.appContext.flapp.navigate("/create/books/"+n.id+"/cover")})},function(e){t.onError(t.intlMessage({intlName:"album-page.ERROR_CREATING_PHOTOBOOK_FROM_ALBUM"}))})},buildContainer:function(){var e,t=this.get("container"),n=this.get("albumModel"),r=!1,i={};this.albumPhotoListLayoutStyle==="justified"&&t.addClass("justified"),this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===n.getValue("owner").id&&(r=!0),i.viewerIsOwner=r,i.enableDownload=!1;if(this.appContext.flipper.isFlipped("enable-just-your-album-download")&&r||this.appContext.flipper.isFlipped("enable-album-download")&&n.getValue("canDownload"))i.enableDownload=!0;return this.subviews["fluid-share-album-view"]&&(i["fluid-share-album-view"]=this.subviews["fluid-share-album-view"].get("container"),(i.viewerIsOwner||i["enable-download"])&&i["fluid-share-album-view"].addClass("not-alone")),e=this.templates("album-engagement")(i),this.setContainerHTML(e),this},buildErrorContainer:function(){},activate:function(){var t=this,n=this.get("container"),r=n.one(".create-book-container"),i=n.one(".download-album-container");return r&&t.registerEventHandler(r.on("click",function(){t.createBookFromAlbum()})),i&&(this.bulkDownloaderView=new e.BulkDownloaderView({appContext:this.appContext}),t.registerEventHandler(i.on("click",t.downloadAlbum.bind(this)))),this},destructor:function(){this.bulkDownloaderView&&this.bulkDownloaderView.destroy()},downloadAlbum:function(t){var n=this,r;e.rapidTracker.beacon(this.name,"openDownloadAlbum"),this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===this.get("albumModel").getValue("owner").id&&this.bulkDownloaderView.set("isOwnAlbum",!0),r=this.bulkDownloaderView.showLoadingDialog(),this.bulkDownloaderView.prepareArchive({set_id:this.albumId}).then(function(e){r.close(),n.bulkDownloaderView.showDownloadDialog(e)}).catch(function(e){r.close(),n.onError(e)})},onParentViewEvent:function(e,t){var n=this,r=n.get("container");if(e==="album-engagement-view"&&t[0]==="albumHeaderView:editing")return r.addClass("invisible"),!1;if(e==="album-engagement-view"&&t[0]==="albumHeaderView:doneEditing")return r.removeClass("invisible"),!1},onError:function(t){return this.errorDialog=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showCancelButton:!1,title:this.intlMessage({intlName:"common.OOPS"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,darkOverlay:!0}),this.errorDialog.show(),this.errorDialog}})},"@VERSION@",{requires:["flickr-view","hermes-template-album-engagement","hermes-template-flickr-balls"],optionalRequires:["bulk-downloader-view"],optional:["fluid-share-album-view"],langBundles:["common","album-page"]});
YUI.add("album-header-view",function(e){var t=.8,n=480,r=60,i={css:{headerContent:".album-header-content"}};e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.albumId=e.albumId,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},subviewConfig:{"album-title-desc-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-stats-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-engagement-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"attribution-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,hideFollowView:!0,additionalViewClasses:["album-attribution"],isAlbumView:!0}},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("set-models",this.albumId)),this.appContext.getViewer().signedIn&&n.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid)),e.Promise.all(n).then(function(e){t.set("albumModel",e[0]),e[1]&&t.set("personPreferenceModel",e[1])})},buildContainer:function(){var n,i,s=this.get("container"),o=this.getAlbumHeaderHeight()-r,u=this.get("albumModel"),a=this.appContext.getViewer().signedIn&&this.appContext.getViewer().nsid===u.getValue("owner").id,f=this.appContext.viewportData.getDevicePixelRatio();return this.albumPhotoListLayoutStyle==="justified"&&(s.addClass("justified-transitions"),s.addClass("justified"),o=300),i=u.registry.getSizeToFit(this.albumId,{width:this.appContext.viewportData.getWidth()*t*f,height:o*f}),i||e.Flog.error("[album-header-view]","Failed to load album coverphoto."),n=this.templates("album-header")({"album-title-desc-view":this.subviews["album-title-desc-view"].get("container"),"album-stats-view":this.subviews["album-stats-view"].get("container"),"album-engagement-view":this.subviews["album-engagement-view"].get("container"),"attribution-view":this.subviews["attribution-view"].get("container"),height:o,"cover-photo-url":i?i.url:"",viewerIsOwner:a}),this.setContainerHTML(n),this},buildErrorContainer:function(){},activate:function(){var t=this,n=this.get("container"),s=n.one(".edit-cover-photo"),o=n.one(".album-header-content"),u=n.one(".avatar"),a,f=this.get("personPreferenceModel");this.albumHeaderElement=this.get("container").one(i.css.headerContent),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.resizeHeader.bind(this))),s&&this.registerEventHandler(s.on("click",this.handleSetCoverPhotoClick.bind(this)));if(this.appContext.flipper.isFlipped("enable-change-album-sorting")){var l=this.get("container").one(".change-album-sorting");l&&this.registerEventHandler(l.on("click",this.handleChangeAlbumSorting.bind(this)))}e.on("albumToolbarView:layoutChange",function(i){f&&(f.setValues({albumViewLayoutPref:i}),f.remoteUpdate()),i==="justified"?(n.addClass("justified-transitions"),n.addClass("justified"),o.setStyle("height",300),u&&e.flutil.onTransitionEnd(u,function(){n.one(".album-attribution").addClass("justified-album-details-page")})):(a=t.getAlbumHeaderHeight()-r+"px",o.setStyle("height",a),n.removeClass("justified"),u&&setTimeout(function(){n.one(".album-attribution").removeClass("justified-album-details-page")},250),e.flutil.onTransitionEnd(o,function(){n.removeClass("justified-transitions")}))})},onSubviewEvent:function(e,t){var n=this.get("container"),r=n.one(".album-header-content"),i=n.one(".edit-cover-photo");if(e==="album-title-desc-view"&&t[0]==="albumTitleDesc:editing")return this.fire("parentViewEvent","albumHeaderView:editing"),i.addClass("hidden"),!1;if(e==="album-title-desc-view"&&t[0]==="albumTitleDesc:doneEditing")return this.fire("parentViewEvent","albumHeaderView:doneEditing"),i.removeClass("hidden"),!1;e==="album-title-desc-view"&&t[0]==="albumTitleDescEditing:heightChange"&&t[1]&&r.setStyle("height",parseInt(r.getComputedStyle("height"),10)+t[1]+"px")},resizeHeader:function(e){var t=this.getAlbumHeaderHeight()-r,n=this.get("container");n.hasClass("justified")||this.albumHeaderElement.setStyle("height",t)},getAlbumHeaderHeight:function(){var e=this.appContext.viewportData.getWidth(),t=this.appContext.viewportData.getHeight()-50,r=1.3,i=2.3,s=2.75,o=120,u=e/r+o,a=e/i+o,f=e/s,l;return t>u?l=e/r:t>a?l=t-o:t>f?l=t-o+o*(t-a)/(f-a):l=t,Math.max(n,Math.round(l))},handleChangeAlbumSorting:function(t){if(!this.appContext.flipper.isFlipped("enable-change-album-sorting"))return;t.halt();var n=this;this.sortingOptionsDialog=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target,minVerticalSpace:250,positionFixed:!0,anchorOffsetHorizontal:20,menuItems:[{text:this.intlMessage({intlName:"album-page.SORT_DATE_TAKEN_NEWEST"}),value:"date-posted-asc"},{text:this.intlMessage({intlName:"album-page.SORT_DATE_TAKEN_OLDEST"}),value:"date-posted-desc"},{text:this.intlMessage({intlName:"album-page.SORT_DATE_UPLOADED_OLDEST"}),value:"date-taken-asc"},{text:this.intlMessage({intlName:"album-page.SORT_DATE_UPLOADED_NEWEST"}),value:"date-taken-desc"},{text:this.intlMessage({intlName:"album-page.SORT_ALPHABETICALLY"}),value:"title"},{text:this.intlMessage({intlName:"album-page.SORT_RANDOMLY"}),value:"random"},{text:this.intlMessage({intlName:"album-page.SORT_REVERSE"}),value:"reverse"}]}),this.registerEventHandler(this.sortingOptionsDialog.on("selected",function(t){t.preventDefault(),n.sortingOptionsDialog.close();if(t.menuItem&&t.menuItem.value){var r={photoset_id:n.get("albumModel").getValue("id"),sort:t.menuItem.value,preview:0};n.loadingModal=new e.Views.FluidModal({appContext:this.appContext,title:n.intlMessage({intlName:"common.LOADING"}),message:n.intlMessage({intlName:"album-page.SORT_ALMOST_DONE"}),showButtons:!1}),n.loadingModal.show(),n.appContext.callAPI("flickr.photosets.sortPhotos",r).then(n.onAlbumSortingChanged.bind(n)).catch(n.onAlbumSortingFailed.bind(n))}})),this.sortingOptionsDialog.show()},onAlbumSortingChanged
:function(t){t.stat==="ok"?e.config.win.location.reload():this.onAlbumSortingFailed(t)},onAlbumSortingFailed:function(t){if(t.stat==="fail"){var n=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.ERROR"}),message:"Error while changing sort",actionButtonLabel:this.intlMessage({intlName:"common.OK"}),showCancelButton:!1});n.show()}},handleSetCoverPhotoClick:function(n){n.preventDefault();var i=this.get("container"),s=this,o=this.get("albumModel"),u=this.templates("flickr-balls")({}),a=i.one(".edit-cover-photo"),f,l,c,h=this.appContext.viewportData.getDevicePixelRatio();f=new e.Views.FluidModal({appContext:s.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:"",navBarView:new e.Views["fluid-modal-nav-bar-view"]({appContext:s.appContext,links:[{id:"photostream",name:this.intlMessage({intlName:"common.PHOTOSTREAM"}),value:"photostream"},{id:"sets",name:this.intlMessage({intlName:"common.ALBUMS"}),value:"sets",selected:!0},{id:"upload",name:this.intlMessage({intlName:"global-nav.UPLOAD"}),value:"upload"}],enableSearch:!0,enableMarketplaceProductsSearch:!1}),actionButtonLabel:this.intlMessage({intlName:"common.SELECT"}),actionButtonDisabled:!0,subview:new e.Views["photo-selector-view"]({appContext:this.appContext,searchable:{yours:!0,contacts:!1,everyone:!1,marketplace:!1},defaultSelected:{id:s.albumId,title:s.get("albumModel").getValue("title"),type:"set"}}),width:752,height:498,fullWindow:!0,classList:"photo-selector",hideModalOverlay:!1}),f.on("actionClick",function(n){a.replace(u);var p=f.get("subview").get("selected");this.appContext.getModel("photo-models",p).then(function(e){return o.hasPhoto(p)===!1?c=o.registry.remote.addPhoto({setID:s.albumId,photoID:p},s.appContext).then(function(){return s.fire("subviewViewEvent","newPhotoAddedToAlbum",p),o.registry.remote.setPrimaryPhoto({photoId:p,albumId:s.albumId},s.appContext)}):c=o.registry.remote.setPrimaryPhoto({photoId:p,albumId:s.albumId},s.appContext),c.then(function(n){l=e.getSizeToFit({width:s.appContext.viewportData.getWidth()*t*h,height:(s.getAlbumHeaderHeight()-r)*h}),o.setValue("primary",e.id),o.setValue("primaryPhotoSizes",e.getValue("sizesForAlbum")),o.setValue("primaryNeedsInterstitial",e.getValue("needsInterstitial")),i.one(".album-header-content").setStyle("background-image","url("+l.url+")"),i.one(".balls").replace(a)})}).then(null,function(t){var n=new e.Views.FluidModal({title:s.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:s.intlMessage({intlName:"common.OK"}),textMessage:s.intlMessage({intlName:"album-page.ERROR_COVER_PHOTO"}),appContext:s.appContext,dismissOnOverlayClick:!0,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!1,hideModalOverlay:!1,showCancelX:!0});n.show(),i.one(".balls").replace(a)})}),f.registerEventHandler(e.on("photoSelector:selected",function(e){f.enableActionButton()})),f.registerEventHandler(e.on("photoSelector:unselected",function(e){f.disableActionButton()})),e.rapidTracker.beacon(s.name,"albumCoverPhotoEdit"),f.show()}})},"@VERSION@",{requires:["flog","flickr-view","hermes-template-album-header","hermes-template-flickr-balls","album-header-css"],optional:["album-title-desc-view","album-stats-view","album-engagement-view","photo-selector-view","fluid-modal-nav-bar-view","photo-list-photo-interaction-view","attribution-view"],langBundles:["album-page","global-nav","common"]});
YUI.add("album-page-view",function(e){var t=190,n=430,r=null,i=3;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(s){return this.albumId=s.albumId,this.isOwner=s.isOwner,this.isTwitterbot=s.isTwitterbot,this.albumPhotoListLayoutStyle=s.albumPhotoListLayoutStyle,s.id=s.albumId,s.modelRegistryName="set-models",s.maxNumAttrName="totalCount",this.pageParams=s.pageParams,s.photoListConfig={modelParams:{registryName:"set-models",modelIdOrAttributes:s.albumId,collectionAttributeName:"photoPageList"},parentName:this.name,pageParams:s.pageParams,contextSuffix:"album-"+s.albumId,measureAFT:!0,maintainScrollPosition:!1,scrollToWithId:s.withPhotoId},s.photoListConfig.layout={targetRowHeight:this.albumPhotoListLayoutStyle==="justified"?t:n,fullWidthBreakoutRowCadence:this.albumPhotoListLayoutStyle==="justified"?r:i,awakeBoundsToViewportSizeRatio:5,containerPadding:{top:4,right:0,bottom:4,left:0},itemSpacing:{horizontal:4,vertical:4}},this.aftHelper=new e.PhotolistAftHelper(this),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"album-toolbar-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"album-header-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"pagination-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return this.pageParams.viewPageSize?!1:!0}},"signup-footer-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(e){return e.isMobile||!this.appContext.flipper.isFlipped("enable-mini-sign-up-footer")||this.appContext.getViewer().signedIn||this.appContext.lang!=="en-US"}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var e=this;return this.appContext.getModel("set-models",this.albumId).then(function(t){e.set("albumModel",t)})},buildContainer:function(){var e;return e={"global-nav-view":this.subviews["global-nav-view"].get("container"),"album-toolbar-view":this.subviews["album-toolbar-view"].get("container"),"album-header-view":this.subviews["album-header-view"].get("container"),"photo-list-view":this.subviews["photo-list-view"].get("container"),"pagination-view":this.subviews["pagination-view"]?this.subviews["pagination-view"].get("container"):"","footer-full-view":this.subviews["footer-full-view"].get("container"),"signup-footer-view":this.subviews["signup-footer-view"]?this.subviews["signup-footer-view"].get("container"):""},this.setContainerHTML(this.templates("album-page")(e)),this},buildHeadContainer:function(){var t=this.get("albumModel"),n=t.getValue("photoPageList").getList(),r="summary",i=[],s,o=(this.pageParams.nominalPage-1)*this.pageParams.viewPageSizeForShare||0,u,a;if(this.isTwitterbot&&n.length-o>=4){r="gallery";for(a=0;a<Math.min(n.length-o,4);a++)n[o+a]?i.push({property:"twitter:image"+a,content:n[o+a].getSizeToFit({width:640,height:640}).url}):e.Flog.error("[album-page-view] missing album photo in album list: "+(o+a))}t.registry?s=t.registry.getSizeToFit(this.albumId,{width:640,height:640}):e.Flog.error("[album-page-view] Missing album model registry!"),u=this.templates("dynamic-page-head")({title:t.getValue("title"),description:t.getValue("description"),url:t.getValue("url"),fullURL:e.url(t.getValue("url")),openGraphImageURL:e.URLHelper.addProtocolToURL(s.url),openGraphaImageWidth:s.width,openGraphaImageHeight:s.height,ownerURL:t.getValue("owner").getValue("url"),twitterCardType:r,twitterImages:i,flickrType:"set",domain:e.url()}),u+=this.templates("head-meta")({isName:!0,metaName:"robots",metaValue:"noarchive"}),u+=this.templates("head-meta")({isName:!0,metaName:"viewport",metaValue:"width=device-width, initial-scale=1, maximum-scale=1"}),u+=this.templates("head-meta")({isName:!0,metaName:"googlebot",metaValue:"noarchive"}),YUI.Env.isServer?this.set("headContainer",u):(this.set("headContainer",u.concat(this.subviews["pagination-view"].get("headContainer"))),this.updateHead())},activate:function(){var s=this,o=this.get("albumModel"),u=o.getValue("isOwner");return e.later(100,this,function(){e.use("photo-page-scrappy-view")}),e.on("albumToolbarView:layoutChange",function(e){var o=s.subviews["photo-list-view"],u=o.photoListLayout;u.targetRowHeight=e==="justified"?t:n,u.fullWidthBreakoutRowCadence=e==="justified"?r:i,o.setItems(s.get("albumModel").getValue("photoPageList").getList())}),u||this.appContext.getViewCounter().recordAlbumView({albumOwnerID:o.getValue("owner").getValue("id"),albumID:o.getValue("id"),referrer:this.appContext.getReferrer()}),this},onSubviewEvent:function(e,t){t&&t[0]==="newPhotoAddedToAlbum"&&this.subviews["photo-list-view"].setItems(this.get("albumModel").getValue("photoPageList").getList())},getTrackingSegments:function(){return{vwrOwner:this.isOwner?1:0}}},{ATTRS:{spaceid:{value:792600538}}})},"@VERSION@",{requires:["flog","flutil","flickr-view","flickr-promise","set-models","hermes-template-album-page","hermes-template-dynamic-page-head","hermes-template-head-meta","hermes-template-head-link","album-page-css","album-toolbar-view","album-header-view","photo-list-view","footer-full-view","photolist-aft-helper","url-helper"],langBundles:["album-page"]});
